Test complete iteration loop with prompt-based tools
